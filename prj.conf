# ----------------------------------------------------
# Otimizacoes, verificacoes
# ----------------------------------------------------
CONFIG_NO_OPTIMIZATIONS=n
CONFIG_ASSERT=y



# ----------------------------------------------------
# Debug
# ----------------------------------------------------
CONFIG_DEBUG=n
CONFIG_DEBUG_OPTIMIZATIONS=n
CONFIG_DEBUG_THREAD_INFO=n
CONFIG_DEBUG_INFO=n



# ----------------------------------------------------
# Bootloader
# ----------------------------------------------------
CONFIG_BOOTLOADER_MCUBOOT=y
CONFIG_MCUMGR=y
CONFIG_MCUMGR_SMP_BT=y
# Enable the Bluetooth (unauthenticated) and shell mcumgr transports.
CONFIG_MCUMGR_SMP_BT_AUTHEN=n 
CONFIG_MCUMGR_CMD_IMG_MGMT=y
CONFIG_MCUMGR_CMD_OS_MGMT=y
#Habilitar isso pra que seja um bootloader secundario e possivel de ser atualizado.
# essa merda aqui fica cagando com o consumo
CONFIG_SECURE_BOOT=n

CONFIG_SB_SIGNING_KEY_FILE="./priv_deicke_A.pem"
 # Habilitar outras chaves publicas que possam ser aceitas eventualmente
# CONFIG_SB_PUBLIC_KEY_FILES="./pub_deicke_B.pem,./pub_deicke_C.pem"

# ---- Logs ----
CONFIG_MCUBOOT_UTIL_LOG_LEVEL_DBG=y



# ----------------------------------------------------
# Particao de configuracoes - somente quando ha boot
# ----------------------------------------------------
CONFIG_PM_PARTITION_SIZE_SETTINGS_STORAGE=0x2000
CONFIG_SETTINGS=y
CONFIG_SETTINGS_NVS=y
CONFIG_NVS=y



# ----------------------------------------------------
# Bluetooth LE
# ----------------------------------------------------
CONFIG_BT_DEVICE_APPEARANCE=1347
CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y
# CONFIG_BT_BROADCASTER=n
# CONFIG_BT_CENTRAL=y 
# Usar controlador SoftDevice da Nordic
CONFIG_BT_LL_SW_SPLIT=n 

# para usar Le Coded Phy (longa distancia)
CONFIG_BT_CTLR_PHY_CODED=y
CONFIG_BT_EXT_ADV=y
CONFIG_BT_USER_PHY_UPDATE=y

# para poder utilizar endereco estatico
CONFIG_BT_SMP=y
CONFIG_BT_PRIVACY=n

# para usar advertising estendido
CONFIG_BT_EXT_ADV=y
CONFIG_BT_GATT_CLIENT=n

CONFIG_BT_DEVICE_NAME_DYNAMIC=y
CONFIG_BT_DEVICE_NAME_MAX=50
CONFIG_BT_DEVICE_NAME_GATT_WRITABLE=y
CONFIG_BT_DEVICE_NAME="XDS-22"

CONFIG_BT_BUF_ACL_RX_SIZE=256
# Segundo a nordic o maximo MTU usando softdevice deve ser 247
CONFIG_BT_L2CAP_TX_MTU=247
# Habilita fragmentacao de pacotes grandes.
# CONFIG_BT_L2CAP_TX_FRAG_COUNT=5
CONFIG_BT_CTLR_DATA_LENGTH_MAX=250
CONFIG_BT_CTLR_TX_PWR_DYNAMIC_CONTROL=y
CONFIG_BT_CTLR_CONN_RSSI=y
CONFIG_BT_CTLR_TX_PWR_PLUS_8=y
# CONFIG_BT_CTLR_ADVANCED_FEATURES=n
# Battery Service 
CONFIG_BT_BAS=y 
# Nordic UART Service
CONFIG_BT_NUS=y 
# LED/Button Service
CONFIG_BT_LBS=n 
# Device Information Service (versao, fabricante, etc)
CONFIG_BT_DIS=y 

# --- Configuracoes DIS  ---
CONFIG_BT_DIS_MANUF="XPTEC"
CONFIG_BT_DIS_MODEL="XDS-22"
CONFIG_BT_DIS_FW_REV=y
CONFIG_BT_DIS_FW_REV_STR="v00.03.05"
CONFIG_BT_DIS_HW_REV=y
CONFIG_BT_DIS_HW_REV_STR="v0.5"
CONFIG_BT_DIS_PNP=n
CONFIG_BT_DIS_SERIAL_NUMBER=n
CONFIG_BT_DIS_SETTINGS=y
CONFIG_BT_DIS_SW_REV=n

# ---- Logs ----
CONFIG_BT_DEBUG_LOG=n



# ----------------------------------------------------
# LOGS, Console, Printf, Scanf
# ----------------------------------------------------
# -- Console, Log --
CONFIG_LOG=y
CONFIG_LOG_MODE_MINIMAL=y
CONFIG_RTT_CONSOLE=y
CONFIG_LOG_BACKEND_RTT=y
CONFIG_UART_CONSOLE=n

CONFIG_LOG_MODE_IMMEDIATE=y
#CONFIG_LOG_PROCESS_THREAD=y
#CONFIG_LOG_PROCESS_THREAD_CUSTOM_PRIORITY=y
#CONFIG_LOG_PROCESS_THREAD_PRIORITY=5

CONFIG_LOG_DEFAULT_LEVEL=4
# CONFIG_LOG_BUFFER_SIZE=32768

CONFIG_PRINTK=y
CONFIG_LOG_PRINTK=y

# -- Strings --
#CONFIG_LOG_DETECT_MISSED_STRDUP=y
#CONFIG_LOG_PRINTK_MAX_STRING_LENGTH=512
#CONFIG_LOG_STRDUP_BUF_COUNT=10
#CONFIG_LOG_STRDUP_MAX_STRING=512

# -- Printf, Scanf, etc --
CONFIG_NEWLIB_LIBC=y
CONFIG_CBPRINTF_FULL_INTEGRAL=y
CONFIG_CBPRINTF_FP_SUPPORT=y
CONFIG_NEWLIB_LIBC_FLOAT_SCANF=y
CONFIG_NEWLIB_LIBC_FLOAT_PRINTF=y
CONFIG_NEWLIB_LIBC_NANO=n



# ----------------------------------------------------
# LoRa, SPI
# ----------------------------------------------------
CONFIG_SPI=y
CONFIG_LORA=y
CONFIG_LORA_SX12XX=y
CONFIG_LORA_LOG_LEVEL_OFF=y

#CONFIG_LORA_LOG_LEVEL=4
#CONFIG_LORA_LOG_LEVEL_DBG=y
#CONFIG_SPI_LOG_LEVEL_OFF=y



# ----------------------------------------------------
# UART
# ----------------------------------------------------
CONFIG_UART_1_NRF_PARITY_BIT=y
CONFIG_UART_INTERRUPT_DRIVEN=n
CONFIG_UART_1_ASYNC=n
CONFIG_UART_ASYNC_API=n
#CONFIG_UART_1_NRF_TX_BUFFER_SIZE=256
#CONFIG_UART_1_NRF_RX_BUFFER_SIZE=256



# ----------------------------------------------------
# GPIOs
# ----------------------------------------------------
CONFIG_GPIO=y

#CONFIG_GPIO_LOG_LEVEL_DBG=y



# ----------------------------------------------------
# JSON
# ----------------------------------------------------
CONFIG_CJSON_LIB=n



# ----------------------------------------------------
# Gerenciamento de Energia / Power Management
# ----------------------------------------------------
CONFIG_PM=y
CONFIG_PM_DEVICE=y
CONFIG_PM_DEVICE_RUNTIME=y
CONFIG_PM_CPU_OPS=y
# CONFIG_PM_DEVICE_RUNTIME_EXCLUSIVE=y
CONFIG_PM_POLICY_DEFAULT=y
CONFIG_PM_DEVICE_POWER_DOMAIN=y

# CONFIG_CAF=y
# CONFIG_CAF_POWER_MANAGER=y
# CONFIG_CAF_POWER_MANAGER_TIMEOUT=120
# CONFIG_CAF_BLE_STATE=y
# CONFIG_CAF_BLE_STATE_PM=y
# CONFIG_CAF_BLE_STATE_EXCHANGE_MTU=y



# ----------------------------------------------------
# Gerenciamento da Flash
# ----------------------------------------------------
CONFIG_MPU_ALLOW_FLASH_WRITE=y



# ----------------------------------------------------
# Regulador interno
# ----------------------------------------------------
# CONFIG_ADJUST_LDO=y
# CONFIG_NRF_APPROTECT_LOCK=y
# CONFIG_NRF_APPROTECT_USE_UICR=y



# ----------------------------------------------------
# HEAP Mem, Stack, Falhas, Thread Analyzer
# ----------------------------------------------------
CONFIG_HEAP_MEM_POOL_SIZE=32768

CONFIG_REBOOT=y
# CONFIG_RESET_ON_FATAL_ERROR=y
#CONFIG_FATAL_ERROR_LOG_LEVEL_DBG=y
#CONFIG_BT_HCI_VS_FATAL_ERROR=y


CONFIG_EXTRA_EXCEPTION_INFO=y

#CONFIG_THREAD_NAME=y
# CONFIG_THREAD_ANALYZER=y
# CONFIG_THREAD_STACK_INFO=y
# CONFIG_THREAD_MONITOR=y
# CONFIG_THREAD_ANALYZER_ISR_STACK_USAGE=y
# CONFIG_THREAD_ANALYZER_AUTO_INTERVAL=5
# #CONFIG_THREAD_ANALYZER_USE_PRINTK=n
# CONFIG_THREAD_ANALYZER_AUTO=y
# CONFIG_THREAD_ANALYZER_USE_LOG=y
# CONFIG_THREAD_ANALYZER_AUTO_STACK_SIZE=65536

CONFIG_INIT_STACKS=y
CONFIG_STACK_USAGE=y
# Aparentemente stack sentinel e mpu stack guard nao podem ser usados simultaneamente (fonte: github, investigar mais a fundo)
#CONFIG_MPU_STACK_GUARD=y 
#CONFIG_STACK_SENTINEL=y


# --- Tamanhos Stacks ---
CONFIG_IDLE_STACK_SIZE=4096
CONFIG_MAIN_STACK_SIZE=8196
CONFIG_ISR_STACK_SIZE=8196
CONFIG_MPSL_WORK_STACK_SIZE=8196
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=8196


CONFIG_BT_RX_STACK_SIZE=4096
CONFIG_BT_HCI_TX_STACK_SIZE=4096
#CONFIG_BT_CTLR_RX_PRIO_STACK_SIZE=1024

CONFIG_PRIVILEGED_STACK_SIZE=8196

#CONFIG_LOG_PROCESS_THREAD_STACK_SIZE=65536
